# AIコーディング基本ルール

## プロジェクトの把握
- `docs/project` に、本プロジェクトの実現に必要なドキュメント一式をまとめます
- まず最初に `planning.md` の作成を行います
    - プロジェクトの開始段階に、あなたとのディスカッションを重ね、プロジェクト全体のアイデア、構造、アーキテクチャ、目標等の策定（プランニング）を行います
    - 私から「ここまでの内容を `planning.md` にまとめて」との指示を行いますので、そのタイミングでそれまでの内容を適切にまとめ `planning.md` として保存する必要があります
    - このファイルはプランニング段階の重要なメモとなり、その後の私とLLMをつなぐ、プロジェクトに対する共通認識のためのドキュメントとなります
- `planning.md` を保存するタイミングに合わせて、必ず以下のドキュメント群の生成が必要です
- 内容は適切に判断しつつ、必要と思われる項目を適宜まとめてください
    - projectbrief.md
        - 他のすべてのファイルを形成する基礎ドキュメント
        - 存在しない場合はプロジェクト開始時に作成
        - 中核となる要件と目標を定義
        - プロジェクトスコープに関する信頼できる情報源
    - productContext.md
        - このプロジェクトが存在する理由
        - それが解決する問題
        - どのように機能すべきか
        - ユーザーエクスペリエンスの目標
    - activeContext.md
        - 現在の作業の焦点
        - 最近の変更点
        - 次のステップ
        - 現在の決定事項と考慮事項
    - systemPatterns.md
        - システムアーキテクチャ
        - 主要な技術的決定
        - 使用されているデザインパターン
        - コンポーネント間の関係
    - techContext.md
        - 使用されている技術
        - 開発セットアップ
        - 技術的な制約
        - 依存関係
    - progress.md
        - 何が機能しているか
        - 何がまだ構築されていないか
        - 現在のステータス
        - 既知の問題
- 上記のファイル常に最新情報への更新を心がけてください
    - 更新時の許可は不要です（自由に更新していただいて構いません）
    - 引き継ぎ資料も兼ねますので、例えば途中から別のLLMに作業を引き継いだ場合でも、スムーズにプロジェクト全体を把握できる情報精度が必要になります

## 実装における基本方針
- 共通・コーディング全般 共通の指針
    - 各ファイルの冒頭にはコメントで仕様を記述する
    - コメントの記述は積極的に行う
    - スペースのみの行は許容しない（改行のみに詰める）
- 設計・モデリング
    - 型定義
        - `types` ディレクトリにアプリケーション内のドメインモデルを集約する
        - 機能、目的別に、細分化して配置する
        - その型がどのように使われるかを JSDoc スタイルのコメントで記述する
    - モデリング手法
        - TypeScript で関数型ドメインモデリングを行う
        - class を使わず関数による実装を優先する
        - 代数的データ型でドメインをモデリングする
        - 可能な限り小さな機能単位でモデル化し、常に紐づくテストを実装し実行する
- テスト
    - TDD (テスト駆動開発) を実施し、アジャイル開発を意識する
    - 原則として、実装ファイルには、必ず遂となるテストファイルが実装されます
    - テストはユニット単位で実装します
    - テストは常に、最新の状態に保つ必要があります
        - 修正が行われた場合も、常に紐づくテストの更新を心掛ける必要があります
    - テスト実行は、必ずプロジェクトのホームディレクトリに `cd` した後に実行する
- セキュリティ対策
    - 機密ファイルを絶対にコミットしない
        - コミット時に未知の機密情報と思われるファイルが確認できた場合は、必ず確認を行う
    - シークレット情報は環境変数を使用する
    - ログや出力に認証情報を含めない
- ソース管理
    - コミット依頼は以下のルールに則り対応を行う
        - コミットメッセージの仕様
            - 日本語で記述
            - 必要な要点を全てカバーしつつ、箇条書きで列挙する
            - 最大10行程を目安に組み立てて欲しい（ただし必要な場合はオーバーしても良い）
        - コミット完了後の処理
            - `prompts_[ブランチ名].md` （例：prompts_main.md）ファイルの末尾にコミット情報を追記で記録する
                - 記録内容は `git log` で得られる以下の情報を基本とする
                    - タイトル
                    - Commit id
                    - Author
                    - Date
                - フォーマットは以下のサンプルの通り（コードブロックで囲う）
                    ```
                    # 〇〇の実装完了
                    - Commit: 83e768019e0665770707c91aaeb1ab3b73d61d68
                    - Author: Hisaya Tanaka <tanaka_hisaya@cygames.co.jp>
                    - Date: Fri Jun 20 14:52:43 2025 +0900`
                    ```

